---
import Button from "./ui/Button.astro";
---

<section
    id="home"
    class="relative min-h-screen flex items-center justify-center px-4 overflow-hidden pt-20"
>
    <!-- Canvas pour les particules interactives (desktop uniquement) -->
    <canvas
        id="particleCanvas"
        class="absolute inset-0 w-full h-full hidden md:block"></canvas>

    <!-- Gradient overlay subtil (mode sombre uniquement) -->
    <div
        class="dark:block hidden absolute inset-0 bg-gradient-to-b from-dark-900/50 via-transparent to-dark-900/80 pointer-events-none"
    >
    </div>

    <!-- Contenu -->
    <div
        class="relative z-10 text-center max-w-4xl mx-auto animate-fade-up pb-16 sm:pb-0"
    >
        <!-- Salutation anim√©e -->
        <div class="mb-6 animate-fade-down">
            <span
                class="inline-block px-4 py-2 rounded-full glass text-primary-400 text-sm font-medium"
            >
                üëã
            </span>
        </div>

        <!-- Titre principal -->
        <h1 class="text-5xl md:text-7xl font-bold mb-6 leading-tight">
            Bonjour, je suis
            <span class="gradient-text block mt-2">
                Baptiste TABAR LABONNE
            </span>
        </h1>

        <!-- Sous-titre avec effet typing -->
        <div class="text-xl md:text-2xl text-dark-300 mb-8 h-8">
            <span id="typing-text" class="border-r-2 border-primary-500"></span>
        </div>

        <!-- Description -->
        <p
            class="text-lg md:text-xl text-dark-400 mb-12 max-w-2xl mx-auto leading-relaxed"
        >
            Je suis apprenti en Mast√®re Architecte Web et je cr√©e des
            applications pens√©es avant tout pour √™tre agr√©ables √† utiliser.
            J‚Äôaime rendre les choses claires, fluides et fiables, autant dans le
            code que dans l‚Äôexp√©rience propos√©e aux utilisateurs.
        </p>

        <!-- CTA Buttons -->
        <div
            class="flex flex-col sm:flex-row items-center justify-center gap-4"
        >
            <Button href="#projects" variant="primary" size="lg">
                <svg
                    class="w-5 h-5 mr-2"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                >
                    <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                    <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"
                    ></path>
                </svg>
                Voir mes projets
            </Button>
            <Button href="#contact" variant="outline" size="lg">
                <svg
                    class="w-5 h-5 mr-2"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                >
                    <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"
                    ></path>
                </svg>
                Me contacter
            </Button>
        </div>
    </div>

    <!-- Scroll indicator (positioned relative to the section, bottom center) -->
    <!-- <div
        class="absolute bottom-8 left-1/2 transform -translate-x-1/2 animate-bounce z-20"
    >
        <a
            href="#about"
            class="text-dark-400 hover:text-primary-400 transition-colors"
            aria-label="Aller √† la section √Ä propos"
        >
            <svg
                class="w-6 h-6"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
            >
                <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M19 14l-7 7m0 0l-7-7m7 7V3"></path>
            </svg>
        </a>
    </div> -->
</section>

<script>
    // Effet de typing
    const texts = [
        "D√©veloppeur Fullstack",
        "Architecte Web",
        "Ing√©nieur d√©veloppement",
        "Consultant informatique",
    ];
    let textIndex = 0;
    let charIndex = 0;
    let isDeleting = false;
    const typingElement = document.getElementById("typing-text");

    function type() {
        const currentText = texts[textIndex];

        if (isDeleting) {
            typingElement!.textContent = currentText.substring(
                0,
                charIndex - 1,
            );
            charIndex--;
        } else {
            typingElement!.textContent = currentText.substring(
                0,
                charIndex + 1,
            );
            charIndex++;
        }

        let timeout = isDeleting ? 50 : 100;

        if (!isDeleting && charIndex === currentText.length) {
            timeout = 2000;
            isDeleting = true;
        } else if (isDeleting && charIndex === 0) {
            isDeleting = false;
            textIndex = (textIndex + 1) % texts.length;
            timeout = 500;
        }

        setTimeout(type, timeout);
    }

    // D√©marrer l'animation apr√®s un court d√©lai
    setTimeout(() => {
        type();
    }, 500);

    // Syst√®me de particules interactives avec effet liquide
    const canvas = document.getElementById(
        "particleCanvas",
    ) as HTMLCanvasElement;
    const isMobile = window.innerWidth < 768;

    // Ne pas ex√©cuter sur mobile
    if (isMobile || !canvas) {
        // Arr√™ter l'ex√©cution si mobile ou canvas non disponible
    } else {
        const ctx = canvas.getContext("2d")!;

        // Ajuster la taille du canvas
        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        resizeCanvas();
        window.addEventListener("resize", resizeCanvas);

        // Position de la souris
        const mouse = {
            x: -1000,
            y: -1000,
            radius: 150,
        };

        document.addEventListener("mousemove", (e) => {
            mouse.x = e.clientX;
            mouse.y = e.clientY;
        });

        document.addEventListener("mouseleave", () => {
            mouse.x = -1000;
            mouse.y = -1000;
        });

        // Classe Particule
        class Particle {
            x: number;
            y: number;
            baseX: number;
            baseY: number;
            vx: number;
            vy: number;
            size: number;
            opacity: number;

            constructor() {
                this.x = Math.random() * canvas.width;
                this.y = Math.random() * canvas.height;
                this.baseX = this.x;
                this.baseY = this.y;
                this.vx = (Math.random() - 0.5) * 0.5;
                this.vy = (Math.random() - 0.5) * 0.5;
                this.size = Math.random() * 3 + 1;
                this.opacity = Math.random() * 0.5 + 0.3;
            }

            update() {
                // Mouvement de base
                this.baseX += this.vx;
                this.baseY += this.vy;

                // Rebond sur les bords
                if (this.baseX < 0 || this.baseX > canvas.width) this.vx *= -1;
                if (this.baseY < 0 || this.baseY > canvas.height) this.vy *= -1;

                // Interaction avec la souris - effet de r√©pulsion liquide
                const dx = mouse.x - this.baseX;
                const dy = mouse.y - this.baseY;
                const distance = Math.sqrt(dx * dx + dy * dy);

                if (distance < mouse.radius) {
                    const force = (mouse.radius - distance) / mouse.radius;
                    const angle = Math.atan2(dy, dx);
                    const repelX = Math.cos(angle) * force * 50;
                    const repelY = Math.sin(angle) * force * 50;

                    this.x = this.baseX - repelX;
                    this.y = this.baseY - repelY;
                } else {
                    // Retour fluide vers la position de base
                    this.x += (this.baseX - this.x) * 0.05;
                    this.y += (this.baseY - this.y) * 0.05;
                }
            }

            draw() {
                ctx.fillStyle = `rgba(26, 117, 255, ${this.opacity})`;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fill();
            }
        }

        // Cr√©er les particules
        const particleCount = 150;
        const particles: Particle[] = [];

        for (let i = 0; i < particleCount; i++) {
            particles.push(new Particle());
        }

        // Dessiner les connexions entre particules proches
        function connectParticles() {
            for (let i = 0; i < particles.length; i++) {
                for (let j = i + 1; j < particles.length; j++) {
                    const dx = particles[i].x - particles[j].x;
                    const dy = particles[i].y - particles[j].y;
                    const distance = Math.sqrt(dx * dx + dy * dy);

                    if (distance < 100) {
                        const opacity = (1 - distance / 100) * 0.2;
                        ctx.strokeStyle = `rgba(26, 117, 255, ${opacity})`;
                        ctx.lineWidth = 1;
                        ctx.beginPath();
                        ctx.moveTo(particles[i].x, particles[i].y);
                        ctx.lineTo(particles[j].x, particles[j].y);
                        ctx.stroke();
                    }
                }
            }
        }

        // Animation
        function animate() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            connectParticles();

            particles.forEach((particle) => {
                particle.update();
                particle.draw();
            });

            requestAnimationFrame(animate);
        }

        animate();
    } // Fin du bloc if (!isMobile)
</script>

<style>
    @keyframes float {
        0%,
        100% {
            transform: translateY(0) translateX(0);
        }
        25% {
            transform: translateY(-20px) translateX(10px);
        }
        50% {
            transform: translateY(-40px) translateX(-10px);
        }
        75% {
            transform: translateY(-20px) translateX(5px);
        }
    }
</style>
